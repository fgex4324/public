<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุชูุงุตู - ุชุทุจูู ุงูุฏุฑุฏุดุฉ ูุงูุชูุงุตู</title>
    <!-- ุฑุจุท ููู ุงูุฃููุงุท ุงูุฑุฆูุณู -->
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome Icons for modern UI elements (ุฃููููุงุช ูุงุฌูุฉ ูุณุชุฎุฏู ุนุตุฑูุฉ) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts - Cairo for Arabic text (ุฎุท ุงููุงูุฑุฉ ูููุตูุต ุงูุนุฑุจูุฉ) -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>

    <!-- ุดุงุดุฉ ุงูุชุญููู ุงูุฃูููุฉ (ุชุธูุฑ ุนูุฏ ุจุฏุก ุชุดุบูู ุงูุชุทุจูู) -->
    <div id="loadingScreen" class="loading-screen active">
        <div class="spinner"></div>
        <p class="loading-text">ุฌุงุฑู ุชุญููู ุงูุชุทุจููุ ุงูุฑุฌุงุก ุงูุงูุชุธุงุฑ...</p>
    </div>

    <!-- ุดุงุดุฉ ุงููุตุงุฏูุฉ (ุชุณุฌูู ุงูุฏุฎูู / ุฅูุดุงุก ุญุณุงุจ) -->
    <div id="authScreen" class="screen auth-screen">
        <div class="auth-card">
            <h2>ุฃููุงู ุจู ูู ุชูุงุตู!</h2>
            <form id="authForm" class="auth-form">
                <input type="email" id="authEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required>
                <input type="password" id="authPassword" placeholder="ูููุฉ ุงููุฑูุฑ" required>
                <button type="submit" id="authSubmitBtn">ุชุณุฌูู ุงูุฏุฎูู</button>
                <p class="auth-error" id="authError"></p>
                <p class="auth-toggle-text">
                    <a href="#" id="toggleAuthMode">ููุณ ูุฏูู ุญุณุงุจุ ูู ุจุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</a>
                </p>
            </form>
        </div>
    </div>

    <!-- ุงูุชุทุจูู ุงูุฑุฆูุณู ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู -->
    <div id="mainApp" class="screen main-app">
        <header>
            <div class="header-left">
                <h1>ุชูุงุตู</h1>
            </div>
            <nav>
                <button id="showPostsBtn" class="nav-button active">
                    <i class="fas fa-bullhorn"></i> ุงูููุดูุฑุงุช
                </button>
                <button id="showChatsBtn" class="nav-button">
                    <i class="fas fa-comments"></i> ุงูุฏุฑุฏุดุงุช
                </button>
                <button id="showAcquaintancesBtn" class="nav-button">
                    <i class="fas fa-users"></i> ุงููุนุงุฑู
                </button>
                <button id="showProfileBtn" class="nav-button">
                    <i class="fas fa-user-circle"></i> ุงูููู ุงูุดุฎุตู
                </button>
            </nav>
            <div class="header-right">
                <button id="toggleDarkModeBtn" title="ุชุจุฏูู ุงููุถุน ุงููููู/ุงูููุงุฑู" class="header-icon-button">
                    <i class="fas fa-moon"></i>
                </button>
                <button id="logoutBtn" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> ุชุณุฌูู ุงูุฎุฑูุฌ
                </button>
            </div>
        </header>

        <!-- ุงูุดุฑูุท ุงูุฌุงูุจู ูููุณุชุฎุฏููู ุงููุชุตููู (ูุธูุฑ ุนูู ุงูุดุงุดุงุช ุงููุจูุฑุฉ) -->
        <aside id="onlineUsersSidebar" class="online-users-sidebar">
            <h3>
                ุงููุชุตููู ุงูุขู <span id="onlineUsersCount" class="online-count">(0)</span>
            </h3>
            <ul id="onlineUsersList" class="online-users-list">
                <!-- ูุงุฆูุฉ ุงููุณุชุฎุฏููู ุงููุชุตููู ุณุชุนุฑุถ ููุง ุจูุงุณุทุฉ JavaScript -->
            </ul>
        </aside>

        <main class="main-content">
            <!-- ูุณู ุงูููุดูุฑุงุช -->
            <section id="postsSection" class="section active">
                <div class="section-header">
                    <h2>ุขุฎุฑ ุงูููุดูุฑุงุช</h2>
                    <button id="refreshPostsBtn" class="icon-button">
                        <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ
                    </button>
                </div>
                <div class="card post-input-area">
                    <textarea id="postContent" placeholder="ูุงุฐุง ูุฏูุฑ ูู ุฐูููุ"></textarea>
                    <div class="post-options">
                        <label class="checkbox-container">
                            <input type="checkbox" id="privatePostCheckbox">
                            <span class="checkmark"></span>
                            ููุดูุฑ ุฎุงุต (ูููุนุงุฑู ููุท)
                        </label>
                        <button id="publishPostBtn" class="primary-button">
                            <i class="fas fa-paper-plane"></i> ูุดุฑ
                        </button>
                    </div>
                </div>
                <div id="postsList" class="posts-list">
                    <!-- ุงูููุดูุฑุงุช ุณุชุนุฑุถ ููุง ุจูุงุณุทุฉ JavaScript -->
                </div>
            </section>

            <!-- ูุณู ุงูุฏุฑุฏุดุงุช -->
            <section id="chatsSection" class="section chats-section">
                <div class="chat-sidebar card">
                    <div class="chat-search-bar">
                        <input type="text" id="searchUserInput" placeholder="ุงุจุญุซ ุนู ูุณุชุฎุฏููู...">
                        <button id="searchUserBtn" class="icon-button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div id="searchResults" class="search-results-list">
                        <!-- ูุชุงุฆุฌ ุงูุจุญุซ ุณุชุนุฑุถ ููุง -->
                    </div>
                    <h3>ุงููุญุงุฏุซุงุช ุงูุฎุงุตุฉ</h3>
                    <div id="chatsList" class="chats-list">
                        <!-- ูุงุฆูุฉ ุงูุฏุฑุฏุดุงุช ุณุชุนุฑุถ ููุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                </div>

                <!-- ุญุงููุฉ ุงูุฏุฑุฏุดุฉ ุงููุนููุฉ (ุชุธูุฑ ูุดุงุดุฉ ูุงููุฉ ุนูู ุงูููุจุงูู ูุฏุงุฎู ุงููุณู ุนูู ุงูุฏูุณูุชูุจ) -->
                <div id="chatContainer" class="chat-container">
                    <div class="chat-header">
                        <button id="closeChatBtn" class="header-icon-button">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <img src="" alt="ุตูุฑุฉ ุงูุฏุฑุฏุดุฉ" class="chat-avatar" id="chatHeaderAvatar">
                        <div class="chat-header-info">
                            <h3 id="chatHeaderName">ุงุณู ุงูุฏุฑุฏุดุฉ</h3>
                            <span id="chatStatus" class="chat-status"></span>
                        </div>
                        <!--
                            ุชู ุฅุฒุงูุฉ ุฃุฒุฑุงุฑ ุฅุฏุงุฑุฉ ุงูุฏุฑุฏุดุฉ ูุคูุชุงู ููุง
                            ูุฃููุง ุชุญุชุงุฌ ูููุทู ูุนูุฏ ูุฎุฑุฌ ุนู ูุทุงู ุงูุฎุทุฉ ุงููุฌุงููุฉ ุงูุฃูููุฉ
                            ุฃู ูุฏ ูุณุจุจ ุชุนููุฏุงุช ุบูุฑ ุถุฑูุฑูุฉ ุญุงููุงู.
                            <div id="chatManagement" class="chat-management" style="display: none;">
                                <button id="banUserBtn" title="ุญุธุฑ ุงููุณุชุฎุฏู">๐ซ</button>
                                <button id="archiveChatBtn" title="ุฃุฑุดูุฉ ุงููุญุงุฏุซุฉ">๐</button>
                                <button id="leaveChatBtn" title="ูุบุงุฏุฑุฉ ุงููุญุงุฏุซุฉ">๐</button>
                            </div>
                        -->
                    </div>
                    <div id="messagesList" class="messages-list">
                        <!-- ุงูุฑุณุงุฆู ุณุชุนุฑุถ ููุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                    <form id="messageInputForm" class="message-input-form">
                        <button type="button" id="recordAudioBtn" title="ุฑุณุงูุฉ ุตูุชูุฉ" class="icon-button">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <textarea id="messageInput" placeholder="ุงูุชุจ ุฑุณุงูุฉ..." rows="1"></textarea>
                        <button type="button" id="emojiPickerBtn" title="ุฅูููุฌู" class="icon-button">
                            <i class="fas fa-smile"></i>
                        </button>
                        <button type="submit" id="sendMessageBtn" title="ุฅุฑุณุงู" class="primary-button">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                    <div id="emojiPicker" class="emoji-picker card">
                        <!-- ุงูุฅูููุฌู ุณุชุนุฑุถ ููุง ุจูุงุณุทุฉ JavaScript -->
                    </div>
                </div>
            </section>

            <!-- ูุณู ุงููุนุงุฑู -->
            <section id="acquaintancesSection" class="section">
                <div class="section-header">
                    <h2>ูุนุงุฑูู</h2>
                    <button id="refreshAcquaintancesBtn" class="icon-button">
                        <i class="fas fa-sync-alt"></i> ุชุญุฏูุซ
                    </button>
                </div>
                <div id="acquaintancesList" class="card user-list-card">
                    <!-- ูุงุฆูุฉ ุงููุนุงุฑู ุณุชุนุฑุถ ููุง -->
                    <div class="empty">ูุง ุชูุฌุฏ ูุฏูู ูุนุงุฑู ุจุนุฏ.</div>
                </div>
            </section>

            <!-- ูุณู ุงูููู ุงูุดุฎุตู -->
            <section id="profileSection" class="section">
                <div class="section-header">
                    <h2>ูููู ุงูุดุฎุตู</h2>
                    <button id="showSettingsBtn" class="primary-button" style="display: none;">
                        <i class="fas fa-cogs"></i> ุฅุนุฏุงุฏุงุช Firebase (ุงููุณุคูู)
                    </button>
                </div>
                <div class="card profile-card">
                    <div class="profile-avatar-wrapper">
                        <img src="https://via.placeholder.com/150/CCCCCC/000000?text=AV" alt="ุตูุฑุฉ ุงูููู ุงูุดุฎุตู" id="profileAvatar" class="profile-avatar">
                        <input type="file" id="profileImageUpload" accept="image/*" style="display: none;">
                        <button id="changeAvatarBtn" class="change-avatar-btn">
                            <i class="fas fa-camera"></i> ุชุบููุฑ ุงูุตูุฑุฉ
                        </button>
                    </div>
                    <h3 id="profileUsername">ุงุณู ุงููุณุชุฎุฏู</h3>
                    <input type="text" id="newUsernameInput" placeholder="ุงุณู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ" style="display: none;">
                    <button id="saveUsernameBtn" class="primary-button" style="display: none;">
                        <i class="fas fa-save"></i> ุญูุธ ุงูุงุณู
                    </button>
                    <span id="profileEmail" class="text-secondary">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: loading...</span>
                    <p id="profileStatusMessage" class="text-secondary">ูุง ุชูุฌุฏ ุญุงูุฉ ูุญุฏุฏุฉ.</p>

                    <div class="profile-stats">
                        <span>ุงูููุดูุฑุงุช: <strong id="postsCount">0</strong></span>
                        <span>ุงููุนุงุฑู: <strong id="acquaintancesCount">0</strong></span>
                        <span>ุงูููุดูุฑุงุช ุงููุญููุธุฉ: <strong id="savedPostsCount">0</strong></span>
                    </div>
                    <div class="profile-actions">
                        <button id="editUsernameBtn" class="secondary-button">
                            <i class="fas fa-edit"></i> ุชุนุฏูู ุงูุงุณู
                        </button>
                        <button id="editStatusMessageBtn" class="secondary-button">
                            <i class="fas fa-comment-alt"></i> ุชุนุฏูู ุงูุญุงูุฉ
                        </button>
                        <label class="checkbox-container">
                            <input type="checkbox" id="privateProfileCheckbox">
                            <span class="checkmark"></span>
                            ููู ุงูููู ุงูุดุฎุตู
                        </label>
                    </div>
                </div>

                <!-- ูุงุฆูุฉ ุงูููุดูุฑุงุช ุงููุญููุธุฉ ูู ุงูููู ุงูุดุฎุตู -->
                <div class="card saved-posts-card">
                    <h3>
                        <i class="fas fa-bookmark"></i> ุงูููุดูุฑุงุช ุงููุญููุธุฉ
                    </h3>
                    <div id="savedPostsList" class="posts-list">
                        <!-- ุงูููุดูุฑุงุช ุงููุญููุธุฉ ุณุชุนุฑุถ ููุง -->
                        <div class="empty">ูุง ุชูุฌุฏ ููุดูุฑุงุช ูุญููุธุฉ.</div>
                    </div>
                </div>

                <!-- ุฅุนุฏุงุฏุงุช Firebase (ููุท ูููุณุคูู) -->
                <div id="settingsCard" class="card settings-card" style="display: none;">
                    <h3>
                        <i class="fas fa-tools"></i> ุฅุนุฏุงุฏุงุช Firebase
                    </h3>
                    <form id="settingsForm" class="settings-form">
                        <label for="apiKeyInput">API Key:</label>
                        <input type="text" id="apiKeyInput" required>

                        <label for="authDomainInput">Auth Domain:</label>
                        <input type="text" id="authDomainInput" required>

                        <label for="databaseURLInput">Database URL:</label>
                        <input type="text" id="databaseURLInput" placeholder="(ุงุฎุชูุงุฑู)" >

                        <label for="projectIdInput">Project ID:</label>
                        <input type="text" id="projectIdInput" required>

                        <label for="storageBucketInput">Storage Bucket:</label>
                        <input type="text" id="storageBucketInput" placeholder="(ุงุฎุชูุงุฑู)">

                        <label for="messagingSenderIdInput">Messaging Sender ID:</label>
                        <input type="text" id="messagingSenderIdInput" required>

                        <label for="appIdInput">App ID:</label>
                        <input type="text" id="appIdInput" required>

                        <button type="button" id="saveFirebaseConfigBtn" class="primary-button">
                            <i class="fas fa-save"></i> ุญูุธ ุฅุนุฏุงุฏุงุช Firebase
                        </button>
                        <p id="firebaseConfigMessage" class="error-message"></p>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Firebase SDK (ุชู ุงูุชุญุฏูุซ ุฅูู 9.1.0 ูุถูุงู ุงูุชูุงูู ูุงูุฃุฏุงุก) -->
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore-compat.js"></script>
    
    <!-- ูููุงุช JavaScript ุงูุฎุงุตุฉ ุจุงููุดุฑูุน -->
    <script src="firebase-config.js"></script>
    <script src="auth.js"></script>
    <script src="firestore.js"></script>
    <script src="app.js"></script>
</body>
</html>